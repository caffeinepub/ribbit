{
  "kind": "build_request",
  "title": "Create/restore frontend app and ensure avatar upload works",
  "priority": "normal",
  "requirements": [
    {
      "id": "REQ-1",
      "text": "Ensure the frontend React application is present and builds/runs successfully using the existing entry points (frontend/index.html loading /src/main.tsx, and frontend/src/main.tsx rendering frontend/src/App.tsx). Fix any missing imports, broken routes, or placeholder/empty components that prevent the frontend from compiling.",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-1"
        ],
        "quotes": [
          "Create front end"
        ]
      },
      "acceptanceCriteria": [
        "`frontend` builds without TypeScript errors.",
        "App renders at least the existing routed pages defined in `frontend/src/App.tsx` without runtime crashes."
      ]
    },
    {
      "id": "REQ-2",
      "text": "Provide a working user avatar upload flow in the frontend User Settings page: allow selecting an image file, generate a preview, compress images client-side (while preserving animated GIFs by skipping recompression), upload the bytes to the backend by calling the existing `saveCallerUserProfile` mutation with `UserProfile.avatar` set, and refresh displayed avatar after a successful save.",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-1",
          "msg-2",
          "msg-3"
        ],
        "quotes": [
          "Create front end",
          "User avatars are still not working why?",
          "Add it"
        ]
      },
      "acceptanceCriteria": [
        "On `/settings` > Avatar section, selecting an image shows a preview before upload.",
        "Saving uploads the avatar via the existing React Query hook/mutation (`useSaveCallerUserProfile`) and shows upload progress when available.",
        "After a successful save, the current avatar display updates to the newly uploaded image (either by invalidating/refetching queries or updating local UI state).",
        "Animated GIF avatars remain animated after upload (no recompression applied to animated GIFs).",
        "User-facing success/error messages are displayed in English."
      ]
    }
  ],
  "constraints": [
    "Do not edit files under `frontend/src/components/ui` (compose these components instead).",
    "Do not modify immutable hook files: `frontend/src/hooks/useInternetIdentity.ts`, `frontend/src/hooks/useInternetIdentity.tsx`, `frontend/src/hooks/useActor.ts`, `frontend/src/main.tsx`.",
    "Backend must remain single-actor with all logic in `backend/main.mo`; only add a migration if an upgrade requires state changes."
  ],
  "nonGoals": [
    "Adding new authentication providers beyond Internet Identity.",
    "Introducing external databases or third-party storage for images.",
    "Building real-time features (websockets, push notifications, chat)."
  ],
  "imageRequirements": {
    "required": [],
    "edits": []
  },
  "userProfileUpdate": {
    "goalsToAdd": [],
    "goalsToRemove": [],
    "preferencesToAdd": [],
    "preferencesToRemove": [],
    "miscToAdd": [],
    "miscToRemove": [],
    "fieldsToSet": {},
    "fieldsToDelete": []
  }
}