{
  "kind": "implementation_plan",
  "version": "1.0",
  "title": "Auto-initialize Froggy Phrase access control on startup",
  "requirements": [
    {
      "id": "REQ-4",
      "summary": "Automatically initialize Froggy Phrase access control on startup by hashing the phrase and calling backend initializeFroggyPhrase once an actor is available.",
      "acceptanceCriteria": [
        "On first page load in a fresh browser profile, the app generates a Froggy Phrase (existing behavior) and then successfully calls `initializeFroggyPhrase(<sha256 phrase hash>)` without user interaction.",
        "After initialization completes, user actions that previously produced \"not authorized\" errors (e.g., liking, creating content, incrementing views where applicable) no longer show authorization errors for Froggy Phrase users.",
        "The initialization call is not executed in a tight loop; it runs at most once per app session (or is otherwise clearly rate-limited/idempotent on the client)."
      ],
      "file_operations": [
        {
          "path": "frontend/src/hooks/useInitializeFroggyPhraseAccessControl.ts",
          "operation": "create",
          "description": "Add a startup hook that waits for a backend actor from useActor(), computes the Froggy Phrase SHA-256 hash via getPhraseHashUserId(), and calls actor.initializeFroggyPhrase(userId) once per app session (use a sessionStorage flag and an in-memory guard to prevent tight loops). Ensure failures do not crash app startup (log and continue)."
        },
        {
          "path": "frontend/src/App.tsx",
          "operation": "modify",
          "description": "Wire the new useInitializeFroggyPhraseAccessControl hook into app startup (in App component) so the initialization runs automatically after ensureDefaultFroggyPhrase() and once an actor is available."
        }
      ]
    }
  ]
}